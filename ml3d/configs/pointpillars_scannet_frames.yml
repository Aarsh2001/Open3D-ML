dataset:
  name: Scannet
    # [scenes|frames] Use point clouds from entire scenes or individual frames
  portion: frames
  # path/to/your/dataset
  dataset_path: /mnt/beegfs/tier1/vcl-nfs-work/ssheorey/Open3D/Datasets/ScanNet-cache
  cache_dir: ./logs/cache
  #  steps_per_epoch_train: 5000

model:
  name: PointPillars
  # path/to/your/checkpoint
  ckpt_path:

  point_cloud_range: [-2, -1.5, 0, 2, 1.5, 3.5]   # TBC
  classes: [
    'cabinet', 'bed', 'chair', 'sofa', 'table', 'door', 'window',
    'bookshelf', 'picture', 'counter', 'desk', 'curtain',
    'refrigerator', 'showercurtrain', 'toilet', 'sink', 'bathtub',
    'garbagebin'
  ]

  loss:
    focal:
      gamma: 2.0
      alpha: 0.25
      loss_weight: 2.0  # *4
    smooth_l1:
      beta: 0.11
      loss_weight: 1.0  # =
    cross_entropy:
      loss_weight: 0.02  # /5

  voxelize:
    max_num_points: 8
    voxel_size: &vsize
      [0.025, 0.025, 3.5]             # TBC
    max_voxels: [16000, 19200]      # [P_train, P_test]

  voxel_encoder:
    in_channels: 3
    feat_channels: [64]
    voxel_size: *vsize

  scatter:
    in_channels: 64
    output_shape: [120, 160]

  backbone:
    in_channels: 64
    out_channels: [64, 128, 256]
    layer_nums: [3, 5, 5]
    layer_strides: [2, 2, 2]

  neck:
    in_channels: [64, 128, 256]
    out_channels: [128, 128, 128]
    upsample_strides: [1, 2, 4]
    use_conv_for_no_stride: false

  head:
    in_channels: 384
    feat_channels: 384
    nms_pre: 100
    score_thr: 0.1
    ranges: [                   # TBC
      [-2, -1.5, 0, 2, 1.5, 3.5]
    ]
    sizes: [
      [0.31681745121546745, 0.3521887681247128, 0.336164608765374],
      [0.43230148860059975, 0.44485183789604377, 0.8338184153912984],
      [0.5978240435381577, 0.5629161650044501, 0.48893231746260496],
      [0.24482312062809664, 1.0140782644642772, 0.794825454931847],
      [0.2097193176315627, 1.0531004514517968, 1.4886453595711515],
      [1.0490932689699568, 0.25189705958357556, 1.2445723113612597],
      [0.47407082019602353, 0.4025886223569797, 1.7377591432709436],
      [0.8196926663246226, 1.0102297602550072, 0.41393674522474166],
      [0.6541598500858052, 0.6491654635237665, 0.898579947470486],
      [0.274979181707218, 1.0037226793716183, 2.0490167507223447],
      [1.4174110475378898, 0.6445244300487505, 0.6302192792879324],
      [1.0208794190153732, 0.2768463200408132, 2.0520080651267003],
      [1.9806602422837822, 0.32901707508681777, 1.003013507267575],
      [0.3251540146107904, 1.9716598761987112, 1.1036193344789218],
      [0.9195143198820834, 0.9412884766393829, 0.8567203824173899],
      [0.7763018136383001, 1.5345305440391963, 0.762513745446081],
      [0.6133595724116482, 2.952937436299103, 0.7976678622052997],
      [0.9964249073454697, 1.0473199473917998, 1.5937484862290456],
      [2.106384702658245, 0.9531318017486802, 0.8483532914390229],
      [1.164374158748691, 2.1960520319375734, 0.8621255548122434],
      [2.081427042132753, 0.530699397563206, 2.030716700623108],
      [3.3250063613006255, 0.7669302477364655, 0.9389969616009513],
      [0.9653402357140067, 4.005133706315162, 0.7438678733407649],
      [2.0460147174411722, 1.6425467590035994, 0.8739978282146021],
      [0.6406000017220499, 2.2045592347414487, 2.164869267902552],
      [3.0741587080469905, 1.8975623095938188, 0.581157405522722],
      [1.9103487607260168, 2.7763948917847885, 0.6638862459675632],
      [3.4313659199309483, 0.5746233075621263, 1.931629131368723],
      [5.760137510299681, 0.8658991326888402, 1.2134851907690365],
      [2.2542174445875545, 1.9253693946168982, 1.5107737707216242],
      [0.7389413988863938, 4.161839142745858, 2.1810378036936933],
      [0.7851292075990121, 6.908806088604507, 1.2444145226780372],
      [2.8925670713417255, 3.447631965311926, 0.8147304306427638],
      [2.5083788273826486, 5.849963854229641, 0.9149640765455035],
      [1.3289614980285231, 11.110872526426576, 1.161735876186474],
      [4.541662463864074, 5.020663235951398, 0.7916915952001959]
    ]

    rotations: [0, 1.57]
    iou_thr: [
      [0.35, 0.5],
      [0.35, 0.5],
      [0.35, 0.5],
      [0.35, 0.5],
      [0.35, 0.5],
      [0.35, 0.5],
      [0.35, 0.5],
      [0.35, 0.5],
      [0.35, 0.5],
      [0.35, 0.5],
      [0.35, 0.5],
      [0.35, 0.5],
      [0.35, 0.5],
      [0.35, 0.5],
      [0.35, 0.5],
      [0.35, 0.5],
      [0.35, 0.5],
      [0.35, 0.5],
    ]                # TBC

  augment:
    PointShuffle: true
    ObjectRangeFilter: true

pipeline:
  name: ObjectDetection
  test_compute_metric: true
  batch_size: 24
  val_batch_size: 24
  save_ckpt_freq: 5
  max_epoch: 200
  main_log_dir: ./logs
  train_sum_dir: ./logs/train_log
  grad_clip_norm: 2
  num_workers: 8

  optimizer:
    lr: 0.003
    betas: [0.95, 0.99]
    weight_decay: 0.01

  # evaluation properties
  overlaps: [
    0.5, 0.5, 0.5,
    0.5, 0.5, 0.5,
    0.5, 0.5, 0.5,
    0.5, 0.5, 0.5,
    0.5, 0.5, 0.5,
    0.5, 0.5, 0.5
  ]                     # TBC
  similar_classes: {
  }
  difficulties: [0, 1, 2, 3, 4]
